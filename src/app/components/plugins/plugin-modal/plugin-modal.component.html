<app-modal *ngIf="isModalOpen && plugin !== null" (close)="isModalOpen = false">

  <button class="w-10 h-10 fixed top-5 right-5" (click)="isModalOpen = false">
    <svg fill="#000000" height="30px" width="30px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 460.775 460.775" xml:space="preserve">
<path d="M285.08,230.397L456.218,59.27c6.076-6.077,6.076-15.911,0-21.986L423.511,4.565c-2.913-2.911-6.866-4.55-10.992-4.55  c-4.127,0-8.08,1.639-10.993,4.55l-171.138,171.14L59.25,4.565c-2.913-2.911-6.866-4.55-10.993-4.55  c-4.126,0-8.08,1.639-10.992,4.55L4.558,37.284c-6.077,6.075-6.077,15.909,0,21.986l171.138,171.128L4.575,401.505  c-6.074,6.077-6.074,15.911,0,21.986l32.709,32.719c2.911,2.911,6.865,4.55,10.992,4.55c4.127,0,8.08-1.639,10.994-4.55  l171.117-171.12l171.118,171.12c2.913,2.911,6.866,4.55,10.993,4.55c4.128,0,8.081-1.639,10.992-4.55l32.709-32.719  c6.074-6.075,6.074-15.909,0-21.986L285.08,230.397z"/>
</svg>
  </button>

  <div class="modal w-[70vw] not-md:w-[90vw]">
    <div class="w-full h-[35%] not-sm:h-1/2 flex justify-between not-sm:flex-col overflow-auto">
      <div class="plugin p-5">
        <img src="{{ plugin.icon64 }}" alt="foto"  height="1">
      <div class="flex flex-col gap-3 m-2">

        <span class="flex gap-2 items-center flex-wrap">
            <span class="text-3xl font-bold">{{ plugin.name }}</span>
            <span class="opacity-50">v{{ plugin.version }}</span>
          </span>

        <h4 class="font-light text-lg">{{plugin.slogan}}</h4>
        <div class="flex justify-between">
          <p>•{{formatCategories(plugin.categories)}}</p>
        </div>
      </div>

      </div>
      <div class="p-7 text-right flex flex-col justify-between not-sm:flex-row not-sm:items-center flex-wrap not-sm:p-3">

        <h4 class="font-light text-lg">{{plugin.downloads}} downloads</h4>

        <div class="flex self-end justify-between not-sm:w-full gap-3">
          <a class="btn w-24 h-12 flex items-center justify-center " *ngIf="plugin.docLink && plugin.docLink !== ''" href="{{plugin.docLink}}">
            <svg class="m-1 rounded-full" xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="20px" fill="#e3e3e3"><path d="M240-80q-50 0-85-35t-35-85v-560q0-50 35-85t85-35h440v640H240q-17 0-28.5 11.5T200-200q0 17 11.5 28.5T240-160h520v-640h80v720H240Zm120-240h240v-480H360v480Zm-80 0v-480h-40q-17 0-28.5 11.5T200-760v447q10-3 19.5-5t20.5-2h40Zm-80-480v487-487Z"/></svg>

            Docs
          </a>
          <a class="btn w-24 h-12 flex items-center justify-center " *ngIf="plugin.githubLink && plugin.githubLink !== ''" href="{{plugin.githubLink}}">
            <svg class="m-1 rounded-full" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="20px" height="20px" viewBox="0 0 24 24">
              <path d="M10.9,2.1c-4.6,0.5-8.3,4.2-8.8,8.7c-0.5,4.7,2.2,8.9,6.3,10.5C8.7,21.4,9,21.2,9,20.8v-1.6c0,0-0.4,0.1-0.9,0.1 c-1.4,0-2-1.2-2.1-1.9c-0.1-0.4-0.3-0.7-0.6-1C5.1,16.3,5,16.3,5,16.2C5,16,5.3,16,5.4,16c0.6,0,1.1,0.7,1.3,1c0.5,0.8,1.1,1,1.4,1 c0.4,0,0.7-0.1,0.9-0.2c0.1-0.7,0.4-1.4,1-1.8c-2.3-0.5-4-1.8-4-4c0-1.1,0.5-2.2,1.2-3C7.1,8.8,7,8.3,7,7.6C7,7.2,7,6.6,7.3,6 c0,0,1.4,0,2.8,1.3C10.6,7.1,11.3,7,12,7s1.4,0.1,2,0.3C15.3,6,16.8,6,16.8,6C17,6.6,17,7.2,17,7.6c0,0.8-0.1,1.2-0.2,1.4 c0.7,0.8,1.2,1.8,1.2,3c0,2.2-1.7,3.5-4,4c0.6,0.5,1,1.4,1,2.3v2.6c0,0.3,0.3,0.6,0.7,0.5c3.7-1.5,6.3-5.1,6.3-9.3 C22,6.1,16.9,1.4,10.9,2.1z"></path>
            </svg>
            Github
          </a>
          <a href="http://localhost:8080/api/plugins/download/{{plugin.id}}" target="_blank" class="btn w-24 h-12 flex items-center justify-center" >
            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M480-320 280-520l56-58 104 104v-326h80v326l104-104 56 58-200 200ZM240-160q-33 0-56.5-23.5T160-240v-120h80v120h480v-120h80v120q0 33-23.5 56.5T720-160H240Z"/></svg>
            {{ langService.getTranslation("plugins", "download") }}
          </a>
        </div>

      </div>


    </div>
    <menu>
      <div class="flex-wrap">
        <button (click)="setPage(0)" [ngClass]="this.isSelected(0) ? 'lselected' : ''" class="m-1" >Descrição</button>
        <button (click)="setPage(1)" [ngClass]="this.isSelected(1) ? 'lselected' : ''" class="m-1">Comandos</button>
        <button (click)="setPage(2)" [ngClass]="this.isSelected(2) ? 'lselected' : ''" class="m-1">Permissões</button>
        <button (click)="setPage(3)" [ngClass]="this.isSelected(3) ? 'lselected' : ''" class="m-1">Atualizações</button>
        <button (click)="setPage(4)" [ngClass]=" 'sm:hidden '  + (this.isSelected(4) ? 'lselected' : '')" class="m-1">Info</button>

      </div>
    </menu>
    <main>
      <div class="text-container" *ngIf="isSelected(0)">
        <app-markdown
          text="{{plugin.description}}"
        />
      </div>
      <div class="text-container" *ngIf="isSelected(1)">
        <app-markdown
          text="{{plugin.commands}}"
        />
      </div>
      <div class="text-container" *ngIf="isSelected(2)">
        <app-markdown
          text="{{plugin.permissions}}"
        />
      </div>
      <div class="text-container" *ngIf="isSelected(3)">
        <div class="relative update-card" *ngFor="let update of plugin.changelog.reverse()">

          <p class="absolute top-1 right-2 opacity-70 hidden xl:flex"><strong>Atualizado em: </strong> {{update.updated | date:'dd/MM/yyyy HH:mm'}}</p>

          <div class="w-1/2">
            <svg xmlns="http://www.w3.org/2000/svg" height="60px" viewBox="0 -960 960 960" width="60px" fill="#e3e3e3"><path d="M160-160v-80h110l-16-14q-52-46-73-105t-21-119q0-111 66.5-197.5T400-790v84q-72 26-116 88.5T240-478q0 45 17 87.5t53 78.5l10 10v-98h80v240H160Zm400-10v-84q72-26 116-88.5T720-482q0-45-17-87.5T650-648l-10-10v98h-80v-240h240v80H690l16 14q49 49 71.5 106.5T800-482q0 111-66.5 197.5T560-170Z"/></svg>
          </div>

          <div class="update-date">
            <h1>{{update.title}}</h1>
            <p class="opacity-70 hidden not-xl:flex"><strong>Atualizado em: </strong> {{update.updated | date:'dd/MM/yyyy HH:mm'}}</p>
            <app-markdown
              text = "{{update.description.replace('\n', '<br>')}}"
            />
            <a href="http://localhost:8080/api/plugins/download-update/{{update.id}}" target="_blank" class="btn w-24 h-12 flex items-center justify-center absolute bottom-3 right-4 hidden  xl:flex" >
              <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M480-320 280-520l56-58 104 104v-326h80v326l104-104 56 58-200 200ZM240-160q-33 0-56.5-23.5T160-240v-120h80v120h480v-120h80v120q0 33-23.5 56.5T720-160H240Z"/></svg>
              {{ langService.getTranslation("plugins", "download") }}
            </a>
            <a href="http://localhost:8080/api/plugins/download-update/{{update.id}}" target="_blank" class="btn w-24 h-12 flex items-center justify-center hidden not-xl:flex" >
              <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M480-320 280-520l56-58 104 104v-326h80v326l104-104 56 58-200 200ZM240-160q-33 0-56.5-23.5T160-240v-120h80v120h480v-120h80v120q0 33-23.5 56.5T720-160H240Z"/></svg>
              {{ langService.getTranslation("plugins", "download") }}
            </a>
          </div>

        </div>
      </div>

      <div class="text-container" *ngIf="isSelected(4)">
        <div class="h-full border-b border-gray-500 dark:border-gray-600 flex flex-col justify-evenly p-2">
          <p class="font-bold">Criado em:</p>
          <p class="font-light">{{plugin.created | date:'dd/MM/yyyy HH:mm'}}</p>
          <p class="font-bold">Atualizado em:</p>
          <p class="font-light">{{plugin.updated |date:'dd/MM/yyyy HH:mm'}}</p>
        </div>
      </div>
      <div class="sidebar">
        <div class="w-full h-full border-b border-gray-500 dark:border-gray-600 flex flex-col justify-evenly p-2">
          <h2 class="font-bold">Criado em:</h2>
          <p class="font-light">{{plugin.created | date:'dd/MM/yyyy HH:mm'}}</p>
          <h2 class="font-bold">Atualizado em:</h2>
          <p class="font-light">{{plugin.updated |date:'dd/MM/yyyy HH:mm'}}</p>
        </div>

      </div>
    </main>
  </div>
</app-modal>
