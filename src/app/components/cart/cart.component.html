<app-modal [blur]="false" *ngIf="isCartOpen" (close)="isCartOpen = false">

  <div class="sidebar">

    <div class="w-full flex justify-around">
      <h2> Meu carrinho: ({{this.cartService.getCart().length}}) </h2>
      <button class="w-10 h-10" (click)="isCartOpen = false">
        <svg fill="#000000" height="30px" width="30px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 460.775 460.775" xml:space="preserve">
<path d="M285.08,230.397L456.218,59.27c6.076-6.077,6.076-15.911,0-21.986L423.511,4.565c-2.913-2.911-6.866-4.55-10.992-4.55  c-4.127,0-8.08,1.639-10.993,4.55l-171.138,171.14L59.25,4.565c-2.913-2.911-6.866-4.55-10.993-4.55  c-4.126,0-8.08,1.639-10.992,4.55L4.558,37.284c-6.077,6.075-6.077,15.909,0,21.986l171.138,171.128L4.575,401.505  c-6.074,6.077-6.074,15.911,0,21.986l32.709,32.719c2.911,2.911,6.865,4.55,10.992,4.55c4.127,0,8.08-1.639,10.994-4.55  l171.117-171.12l171.118,171.12c2.913,2.911,6.866,4.55,10.993,4.55c4.128,0,8.081-1.639,10.992-4.55l32.709-32.719  c6.074-6.075,6.074-15.909,0-21.986L285.08,230.397z"/>
</svg>
      </button>
    </div>

    <div class="items">
      <div class="item" *ngFor="let item of cartService.getCart()">

        <app-img src="{{item.imageUrl}}" alt="foto"  />
        <div class="w-2/3 d-flex flex-col">
          <h2>{{item.name}}</h2>
            <div class="flex items-center mt-2 mb-2">
              <div class="quantity">
                <button class="w-1/4 border-r-1 border-r-gray-600 rounded-l-2xl" (click)="cartService.removeQuantity(item)">-</button>
                <p class="w-1/2" >{{item.quantity}}</p>
                <button class="w-1/4 border-l-1 border-l-gray-600 rounded-r-2xl" (click)="cartService.addQuantity(item)">+</button>
              </div>
              <p class="ml-3">R${{((item.price * item.quantity) / 100).toFixed(2)}}</p>
            </div>
          <button class="w-full h-10 flex items-center remove" (click)="cartService.removeFromCart(item)">
            <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
              <path class="remove" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 7h14m-9 3v8m4-8v8M10 3h4a1 1 0 0 1 1 1v3H9V4a1 1 0 0 1 1-1ZM6 7h12v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7Z"></path>
            </svg>
            Remover do carrinho
          </button>
        </div>

      </div>
    </div>

    <div class="coupon">
      <p class="text-lg m-2">Adicione um cupom de desconto:</p>
      <div class="flex w-full">
        <input type="text" [(ngModel)]="coupon" class="w-2/3" placeholder="Cupom de desconto" >
        <button class="btn w-1/3" (click)="this.cartService.applyCoupon(coupon)">Aplicar</button>
      </div>
      <div *ngIf="cartService.getCoupon() != null" class="mt-3 flex justify-center">
        <p class="mr-2">Cupom aplicado: </p>
        <p style="color: #58ce58;"> {{cartService.getCoupon()?.code}}</p>
      </div>
    </div>

    <div class="payment">

      <div class="flex justify-between w-full mb-2">
        <p>Total:</p>
        <p>R${{ this.cartService.getTotal().toFixed(2) }}</p>
      </div>

      <div class="flex justify-between w-full mb-2">
        <p>Desconto:</p>
        <p style="color: #58ce58;">-R${{ this.cartService.getDiscount().toFixed(2) }}</p>
      </div>

      <div class="flex justify-between w-full">
        <p>Valor final:</p>
        <p>R${{ this.cartService.getFinalAmount().toFixed(2) }}</p>
      </div>

    </div>

    <a href="" class="btn w-[80%] h-10 flex items-center justify-center">Ir para o pagamento</a>

  </div>

</app-modal>
